<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">

    <title>Document</title>
</head>
<body>

    <div class="container ">
        <div class="row mt-5 ">
            <div class="col-4">
                    <!--  -->
                <div class=" ms-3  rounded-3 shadow border p-3 ">
                    <div class="   ">
                        <small><a href="/users/profile" class="text-decoration-none text-black text-uppercase fw-bold ">My Profile</a></small>
                    </div>
                    <hr>
                    <div class=" ">
                        <small><a href="/users/profile/cartItems" class="text-decoration-none text-black text-uppercase fw-bold ">Cart</a></small>
                    </div>
                    <hr>
                    <div class="">
                        <small><a href="/users/profile/wishlist" class="text-decoration-none text-black text-uppercase fw-bold ">Wishlist</a></small>            
                    </div>
                    <hr>
                    <div class=" ">
                        <small><a href="" class="text-decoration-none text-black text-uppercase fw-bold ">My Orders</a></small>            
                    </div>
                    <hr>
                    <div class=" ">
                        <small><a href="/users/profile/manageAddress" class="text-decoration-none text-black text-uppercase fw-bold ">Manage Address</a></small>            
                    </div>
                    <hr>
                    <div class=" ">
                        <small><a href="" class="text-decoration-none text-black text-uppercase fw-bold ">Change Password</a></small>            
                    </div>
                </div>
                    <!--  -->
            </div>


            <!--  -->
            <div class="col-8 bg-info">

                <div class="col-lg-8 rounded-3 bg-profile ms-3 ">
                    <div class=" pt-2">
                        <span class="text-black text-capitalize fs-4 fw-bolder">My Profile</span>
                        <!-- profile add -->
                        <div class="float-end col-1 mt-2">
                          <div class="profilePage border rounded-3  no-cursor" style="background-image: url('/img/users/<%=currentUser.photo%>');">
                          </div>     
                        </div>
                    </div>
                    <small class="fw-bold">Your Cart items will showup here</small>
                    <hr>
              
                    <div class="d-flex justify-content-between"> 
                        
                        <div class="d-flex flex-column col-12"> 
                            <% if(userCart != null && userCart.products.length != 0) { %> 
                                <% userCart.products.forEach((product, i) => { %>
                                  <div class="row bg-black rounded my-2 p-3 col-lg-12 bg-info cartbox" style="border: 1px solid #beb2c0; background: linear-gradient(316deg, #a0949d 0%, #879092 74%) !important;">
                                      <div class="col-lg-4 col-12 prod-img text-center d-flex align-items-center">
                                          <img src="/img/books/<%=product.name.thumbnail%>" alt="" height="150px" />
                                      </div>
                                      <div class="col-lg-8 prod-details">
                                          <h5 class="text-white"><a href="/products/<%= product.name._id %>" class="text-white text-decoration-none"><%= product.name.name %></a></h5>
                                          <h6 class="text-white mb-2"><%= product.name.author.name %></h6>
                                          <div class="d-flex gap-3 mb-2">
                                              <span class="text-success fw-bold">Price: ₹<%= product.name.price %></span>
                                              <span class="text-warning fs-5"><del> ₹<%= product.name.initialPrice %></del></span>
                                          </div>
                                          <% if(product.name.stock == '0') { %> 
                                              <p class="text-danger fw-bold mt-2">OUT OF STOCK</p>
                                              <p id="stockCheck" class="d-none"><%= product.name.stock %></p>
                                          <% } else { %>
                                              <p class="mt-2"><span class="fw-bold">Stock</span>: <%= product.name.stock %></p>
                                          <% } %>
                                          <div class="d-flex justify-content-end mt-2">
                                              <div class="counter d-flex p-1 align-items-center rounded mx-4">
                                                  <button class="btn btn-sm btn-light" id="minusBtn<%= i %>" onclick='changeCount("<%= product.name._id %>","<%= i %>",-1)'>
                                                      <i class="fa fa-minus"></i>
                                                  </button>
                                                  <span id="cartCount<%= i %>" class="fw-bold px-2"><%= product.quantity %></span>
                                                  <button class="btn btn-sm btn-light" onclick='changeCount("<%= product.name._id %>","<%= i %>",1)'>
                                                      <i class="fa fa-plus h-100"></i>
                                                  </button>
                                              </div>
                                              <button class="btn btn-sm text-white" style="background-color: rgb(88, 11, 11);" onclick="removeFromCart('<%= product.name._id %>')">
                                                  Remove
                                              </button>
                                          </div>
                                      </div>
                                  </div>
                                  <% }) %>
                            
                        </div>
                      </div>
          
                      
                        <div class="col-lg-4 my-3 position-sticky sticky-bottom"> 
                            <div class="order-summary rounded p-3 my-3 d-flex flex-column text-white" style="border: 1px solid #2b152e; font-size: 0.9rem;background: linear-gradient(316deg, #20041a 0%, #010f13 74%)">
                                <div class="d-flex justify-content-between p-1 text-white">
                                    <span>Total items:</span>
                                    <span id="totalItems"><%=userCart.totalQuantity%></span>
                                </div>
                                <div class="d-flex justify-content-between p-1">
                                    <span>Products:</span>
                                    <span id="totalProducts"><%=userCart.products.length%></span>
                                </div>
                                <div class="d-flex justify-content-between p-1">
                                    <span>Price:</span>
                                    <span id="totalPrice">₹ <%=userCart.totalPrice%></span>
                                </div>
                            </div>
                            <div class="order-summary rounded p-3 my-3 d-flex flex-column" style="border: 1px solid #2b152e; font-size: 0.9rem;background: linear-gradient(316deg, #20041a 0%, #010f13 74%)">
                                <a onclick="checkOut()" type="submit" class="text-white btn btn-sm button-div" style="background-color: rgb(18, 82, 9);">Checkout</a>
                            </div>
                            <% } else { %>
                              <h5 class="text-center my-4 fw-light">No products on your cart yet.</h5>
                              <div class="text-center my-4 fw-bold">
                                  <a href="/categories?category=newReleases" class="fst-italic">Continue shopping <i class="fa fa-arrow-right"></i></a>
                              </div>
                          <% } %>
                        </div>
                </div>
          

            </div>
        
        </div>
    </div>
    
</body>
</html>